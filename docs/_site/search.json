[
  {
    "objectID": "get_started.html",
    "href": "get_started.html",
    "title": "Get started with polarstate",
    "section": "",
    "text": "This is a reproducible example that shows how to use polarstate, and compare the outputs to {lifelines} package.\nFirst: Import polars as a dependency:\n\nimport polars as pl\n\n\nCompeting Risks Example\n\npolarstate (Py ğŸ)lifelines (Py ğŸ)tidycmprsk (R ğŸ”µ)\n\n\n\nfrom polarstate import prepare_event_table\n\ntimes_and_reals = pl.DataFrame({\n    \"times\": [24.1, 9.7, 49.9, 18.6, 34.8, 14.2, 39.2, 46.0, 31.5, 4.3],\n    \"reals\": [1, 1, 1, 1, 0, 2, 1, 2, 0, 1]\n})\n\nevent_table = prepare_event_table(times_and_reals)\n\nprint(event_table)\n\nshape: (10, 15)\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ times â”† count_0 â”† count_1 â”† count_2 â”† â€¦ â”† trainsition_ â”† trainsition â”† state_occup â”† state_occup â”‚\nâ”‚ ---   â”† ---     â”† ---     â”† ---     â”†   â”† probabilitie â”† _probabilit â”† ancy_probab â”† ancy_probab â”‚\nâ”‚ f64   â”† i64     â”† i64     â”† i64     â”†   â”† s_to_1â€¦      â”† ies_to_2â€¦   â”† ility_1_â€¦   â”† ility_2_â€¦   â”‚\nâ”‚       â”†         â”†         â”†         â”†   â”† ---          â”† ---         â”† ---         â”† ---         â”‚\nâ”‚       â”†         â”†         â”†         â”†   â”† f64          â”† f64         â”† f64         â”† f64         â”‚\nâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\nâ”‚ 4.3   â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.1          â”† 0.0         â”† 0.1         â”† 0.0         â”‚\nâ”‚ 9.7   â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.1          â”† 0.0         â”† 0.2         â”† 0.0         â”‚\nâ”‚ 14.2  â”† 0       â”† 0       â”† 1       â”† â€¦ â”† 0.0          â”† 0.1         â”† 0.2         â”† 0.1         â”‚\nâ”‚ 18.6  â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.1          â”† 0.0         â”† 0.3         â”† 0.1         â”‚\nâ”‚ 24.1  â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.1          â”† 0.0         â”† 0.4         â”† 0.1         â”‚\nâ”‚ 31.5  â”† 1       â”† 0       â”† 0       â”† â€¦ â”† 0.0          â”† 0.0         â”† 0.4         â”† 0.1         â”‚\nâ”‚ 34.8  â”† 1       â”† 0       â”† 0       â”† â€¦ â”† 0.0          â”† 0.0         â”† 0.4         â”† 0.1         â”‚\nâ”‚ 39.2  â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.166667     â”† 0.0         â”† 0.566667    â”† 0.1         â”‚\nâ”‚ 46.0  â”† 0       â”† 0       â”† 1       â”† â€¦ â”† 0.0          â”† 0.166667    â”† 0.566667    â”† 0.266667    â”‚\nâ”‚ 49.9  â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.166667     â”† 0.0         â”† 0.733333    â”† 0.266667    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n\n\nPrediction for Specific Time-Horizons\n\nfrom polarstate import predict_aj_estimates\n\npredict_aj_estimates(event_table, pl.Series([10.0, 20.0, 30.0, 40.0, 50.0]))\n\n\nshape: (5, 5)\n\n\n\ntimes\nstate_occupancy_probability_0\nstate_occupancy_probability_1\nstate_occupancy_probability_2\nestimate_origin\n\n\nf64\nf64\nf64\nf64\nenum\n\n\n\n\n10.0\n0.8\n0.2\n0.0\n\"fixed_time_horizons\"\n\n\n20.0\n0.6\n0.3\n0.1\n\"fixed_time_horizons\"\n\n\n30.0\n0.5\n0.4\n0.1\n\"fixed_time_horizons\"\n\n\n40.0\n0.333333\n0.566667\n0.1\n\"fixed_time_horizons\"\n\n\n50.0\n-5.5511e-17\n0.733333\n0.266667\n\"fixed_time_horizons\"\n\n\n\n\n\n\n\n\n\n\nimport pandas as pd\nfrom lifelines import AalenJohansenFitter\n\ndf = pd.DataFrame({\n    \"duration\": [24.1, 9.7, 49.9, 18.6, 34.8, 14.2, 39.2, 46.0, 31.5, 4.3],\n    \"event\":    [1, 1, 1, 1, 0, 2, 1, 2, 0, 1]\n})\n\najf_priamry = AalenJohansenFitter()\najf_priamry.fit(df[\"duration\"], df[\"event\"], event_of_interest=1)\n\nprint(\"Event Table for event type 1\")\nprint(ajf_priamry.cumulative_density_)\n\najf_competing = AalenJohansenFitter()\najf_competing.fit(df[\"duration\"], df[\"event\"], event_of_interest=2)\n\nprint(\"Event Table for event type 2\")\nprint(ajf_competing.cumulative_density_)\n\nEvent Table for event type 1\n             CIF_1\nevent_at          \n0.0       0.000000\n4.3       0.100000\n9.7       0.200000\n14.2      0.200000\n18.6      0.300000\n24.1      0.400000\n31.5      0.400000\n34.8      0.400000\n39.2      0.566667\n46.0      0.566667\n49.9      0.733333\nEvent Table for event type 2\n             CIF_2\nevent_at          \n0.0       0.000000\n4.3       0.000000\n9.7       0.000000\n14.2      0.100000\n18.6      0.100000\n24.1      0.100000\n31.5      0.100000\n34.8      0.100000\n39.2      0.100000\n46.0      0.266667\n49.9      0.266667\n\n\n\nPrediction for Specific Time-Horizons\n\nprint(\"Cumulative incidence for event type 1 at times 10.0, 20.0, 30.0, 40.0, 50.0:\")\nprint(ajf_priamry.predict([10.0, 20.0, 30.0, 40.0, 50.0]))\n\nprint(\"Cumulative incidence for event type 2 at times 10.0, 20.0, 30.0, 40.0, 50.0:\")\nprint(ajf_competing.predict([10.0, 20.0, 30.0, 40.0, 50.0]))\n\nCumulative incidence for event type 1 at times 10.0, 20.0, 30.0, 40.0, 50.0:\n10.0    0.200000\n20.0    0.300000\n30.0    0.400000\n40.0    0.566667\n50.0    0.733333\nName: CIF_1, dtype: float64\nCumulative incidence for event type 2 at times 10.0, 20.0, 30.0, 40.0, 50.0:\n10.0    0.000000\n20.0    0.100000\n30.0    0.100000\n40.0    0.100000\n50.0    0.266667\nName: CIF_2, dtype: float64\n\n\n\n\n\nlibrary(tidycmprsk)\ncuminc(Surv(ttdeath, death_cr) ~ 1, trial)\n\ntimes_and_reals &lt;- data.frame(\n  times = c(24.1, 9.7, 49.9, 18.6, 34.8, 14.2, 39.2, 46.0, 31.5, 4.3),\n  reals = factor(c(1, 1, 1, 1, 0, 2, 1, 2, 0, 1),\n                 levels = c(0, 1, 2),\n                 labels = c(\"censored\", \"primary_event\", \"competing_event\"))\n)\n\n(cuminc(Surv(times, reals) ~ 1, times_and_reals)) |&gt;\n    tidy() |&gt;\n    print()\n\n\n\n\n\n\nNo Compating Risks Example\n\npolarstate (Py ğŸ)lifelines (Py ğŸ)\n\n\n\nfrom lifelines import AalenJohansenFitter\nfrom lifelines.datasets import load_waltons\nfrom polarstate import prepare_event_table\n\n\nT, E = load_waltons()['T'], load_waltons()['E']\n\ntimes_and_reals = pl.DataFrame({\n        \"times\": T,\n        \"reals\": E\n    })\n\nresult = prepare_event_table(times_and_reals)\n\nprint(result)\n\nshape: (32, 15)\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ times â”† count_0 â”† count_1 â”† count_2 â”† â€¦ â”† trainsition_ â”† trainsition â”† state_occup â”† state_occup â”‚\nâ”‚ ---   â”† ---     â”† ---     â”† ---     â”†   â”† probabilitie â”† _probabilit â”† ancy_probab â”† ancy_probab â”‚\nâ”‚ f64   â”† i64     â”† i64     â”† i64     â”†   â”† s_to_1â€¦      â”† ies_to_2â€¦   â”† ility_1_â€¦   â”† ility_2_â€¦   â”‚\nâ”‚       â”†         â”†         â”†         â”†   â”† ---          â”† ---         â”† ---         â”† ---         â”‚\nâ”‚       â”†         â”†         â”†         â”†   â”† f64          â”† f64         â”† f64         â”† f64         â”‚\nâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\nâ”‚ 6.0   â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.006135     â”† 0.0         â”† 0.006135    â”† 0.0         â”‚\nâ”‚ 7.0   â”† 1       â”† 1       â”† 0       â”† â€¦ â”† 0.006135     â”† 0.0         â”† 0.01227     â”† 0.0         â”‚\nâ”‚ 9.0   â”† 0       â”† 3       â”† 0       â”† â€¦ â”† 0.01852      â”† 0.0         â”† 0.03079     â”† 0.0         â”‚\nâ”‚ 13.0  â”† 0       â”† 3       â”† 0       â”† â€¦ â”† 0.01852      â”† 0.0         â”† 0.04931     â”† 0.0         â”‚\nâ”‚ 15.0  â”† 0       â”† 2       â”† 0       â”† â€¦ â”† 0.012347     â”† 0.0         â”† 0.061656    â”† 0.0         â”‚\nâ”‚ â€¦     â”† â€¦       â”† â€¦       â”† â€¦       â”† â€¦ â”† â€¦            â”† â€¦           â”† â€¦           â”† â€¦           â”‚\nâ”‚ 63.0  â”† 0       â”† 9       â”† 0       â”† â€¦ â”† 0.06023      â”† 0.0         â”† 0.81931     â”† 0.0         â”‚\nâ”‚ 66.0  â”† 0       â”† 3       â”† 0       â”† â€¦ â”† 0.020077     â”† 0.0         â”† 0.839386    â”† 0.0         â”‚\nâ”‚ 68.0  â”† 1       â”† 9       â”† 0       â”† â€¦ â”† 0.06023      â”† 0.0         â”† 0.899616    â”† 0.0         â”‚\nâ”‚ 69.0  â”† 1       â”† 12      â”† 0       â”† â€¦ â”† 0.086043     â”† 0.0         â”† 0.985659    â”† 0.0         â”‚\nâ”‚ 75.0  â”† 0       â”† 1       â”† 0       â”† â€¦ â”† 0.014341     â”† 0.0         â”† 1.0         â”† 0.0         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n\n\n\n\nfrom lifelines import AalenJohansenFitter\nfrom lifelines.datasets import load_waltons\nT, E = load_waltons()['T'], load_waltons()['E']\najf = AalenJohansenFitter(calculate_variance=True)\najf.fit(T, E, event_of_interest=1)\najf.cumulative_density_\n\n\n\n\n\n\n\n\nCIF_1\n\n\nevent_at\n\n\n\n\n\n0.0\n0.000000\n\n\n6.0\n0.006135\n\n\n7.0\n0.012270\n\n\n9.0\n0.030790\n\n\n13.0\n0.049310\n\n\n15.0\n0.061656\n\n\n17.0\n0.067830\n\n\n19.0\n0.086350\n\n\n22.0\n0.111043\n\n\n26.0\n0.141910\n\n\n29.0\n0.172776\n\n\n32.0\n0.178949\n\n\n33.0\n0.197469\n\n\n36.0\n0.209816\n\n\n38.0\n0.222163\n\n\n41.0\n0.265376\n\n\n43.0\n0.271549\n\n\n45.0\n0.327109\n\n\n47.0\n0.333339\n\n\n48.0\n0.383183\n\n\n51.0\n0.401875\n\n\n53.0\n0.445488\n\n\n54.0\n0.457949\n\n\n56.0\n0.570097\n\n\n58.0\n0.595019\n\n\n60.0\n0.688476\n\n\n61.0\n0.745695\n\n\n62.0\n0.759079\n\n\n63.0\n0.819310\n\n\n66.0\n0.839386\n\n\n68.0\n0.899616\n\n\n69.0\n0.985659\n\n\n75.0\n1.000000\n\n\n\n\n\n\n\n\n\n\n\n\nPerformance Comparison\nHere we compare the performance of polarstate and lifelines for the same task.\n\nimport timeit\n\nimport pandas as pd\nimport polars as pl\nfrom lifelines import AalenJohansenFitter\nfrom lifelines.datasets import load_waltons\n\nfrom polarstate import prepare_event_table\n\n# Load the dataset\nT, E = load_waltons()[\"T\"], load_waltons()[\"E\"]\n\n# Prepare data for polarstate\npolarstate_data = pl.DataFrame({\"times\": T, \"reals\": E})\n\n# Prepare data for lifelines\nlifelines_data = pd.DataFrame({\"duration\": T, \"event\": E})\n\n\n# Time polarstate\npolarstate_time = timeit.timeit(\n    \"prepare_event_table(polarstate_data)\",\n    globals=globals(),\n    number=100,\n)\n\n# Time lifelines\najf = AalenJohansenFitter(calculate_variance=True)\nlifelines_time = timeit.timeit(\n    'ajf.fit(lifelines_data[\"duration\"], lifelines_data[\"event\"], event_of_interest=1)',\n    globals=globals(),\n    number=100,\n)\n\nprint(f\"polarstate execution time: {polarstate_time:.4f} seconds (for 100 executions)\")\nprint(f\"lifelines execution time: {lifelines_time:.4f} seconds (for 100 executions)\")\n\npolarstate execution time: 0.2604 seconds (for 100 executions)\nlifelines execution time: 10.5296 seconds (for 100 executions)"
  },
  {
    "objectID": "reference/index.html",
    "href": "reference/index.html",
    "title": "Function reference",
    "section": "",
    "text": "Introduction to the package.\n\n\n\nFunctions to inspect docstrings.\n\n\n\naj\n\n\n\npredict",
    "crumbs": [
      "Reference",
      "Function reference"
    ]
  },
  {
    "objectID": "reference/index.html#getting-started",
    "href": "reference/index.html#getting-started",
    "title": "Function reference",
    "section": "",
    "text": "Introduction to the package.",
    "crumbs": [
      "Reference",
      "Function reference"
    ]
  },
  {
    "objectID": "reference/index.html#some-functions",
    "href": "reference/index.html#some-functions",
    "title": "Function reference",
    "section": "",
    "text": "Functions to inspect docstrings.\n\n\n\naj\n\n\n\npredict",
    "crumbs": [
      "Reference",
      "Function reference"
    ]
  },
  {
    "objectID": "reference/aj.html",
    "href": "reference/aj.html",
    "title": "aj",
    "section": "",
    "text": "aj\n\n\n\n\n\nName\nDescription\n\n\n\n\nprepare_event_table\nGenerate the full event table from raw times and reals data.\n\n\n\n\n\naj.prepare_event_table(times_and_reals)\nGenerate the full event table from raw times and reals data.\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\nDefault\n\n\n\n\ntimes_and_reals\npl.DataFrame\nA Polars DataFrame containing at least times and reals columns.\nrequired\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\n\n\n\n\n\npl.DataFrame\nThe event table with all intermediate columns computed.",
    "crumbs": [
      "Reference",
      "Some functions",
      "aj"
    ]
  },
  {
    "objectID": "reference/aj.html#functions",
    "href": "reference/aj.html#functions",
    "title": "aj",
    "section": "",
    "text": "Name\nDescription\n\n\n\n\nprepare_event_table\nGenerate the full event table from raw times and reals data.\n\n\n\n\n\naj.prepare_event_table(times_and_reals)\nGenerate the full event table from raw times and reals data.\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\nDefault\n\n\n\n\ntimes_and_reals\npl.DataFrame\nA Polars DataFrame containing at least times and reals columns.\nrequired\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\n\n\n\n\n\npl.DataFrame\nThe event table with all intermediate columns computed.",
    "crumbs": [
      "Reference",
      "Some functions",
      "aj"
    ]
  },
  {
    "objectID": "reference/predict.html",
    "href": "reference/predict.html",
    "title": "predict",
    "section": "",
    "text": "predict\n\n\n\n\n\nName\nDescription\n\n\n\n\npredict_aj_estimates\nPredict state-occupancy probabilities at fixed_time_horizons.\n\n\n\n\n\npredict.predict_aj_estimates(\n    event_table,\n    fixed_time_horizons,\n    full_event_table=False,\n)\nPredict state-occupancy probabilities at fixed_time_horizons.\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\nDefault\n\n\n\n\nevent_table\npl.DataFrame\nThe event table created by :func:prepare_event_table.\nrequired\n\n\nfixed_time_horizons\npl.Series\nTimes at which to obtain the state-occupancy probabilities.\nrequired\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\n\n\n\n\n\npl.DataFrame\nDataFrame with fixed_time_horizons and the estimated probabilities for states 0, 1 and 2.",
    "crumbs": [
      "Reference",
      "Some functions",
      "predict"
    ]
  },
  {
    "objectID": "reference/predict.html#functions",
    "href": "reference/predict.html#functions",
    "title": "predict",
    "section": "",
    "text": "Name\nDescription\n\n\n\n\npredict_aj_estimates\nPredict state-occupancy probabilities at fixed_time_horizons.\n\n\n\n\n\npredict.predict_aj_estimates(\n    event_table,\n    fixed_time_horizons,\n    full_event_table=False,\n)\nPredict state-occupancy probabilities at fixed_time_horizons.\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\nDefault\n\n\n\n\nevent_table\npl.DataFrame\nThe event table created by :func:prepare_event_table.\nrequired\n\n\nfixed_time_horizons\npl.Series\nTimes at which to obtain the state-occupancy probabilities.\nrequired\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nName\nType\nDescription\n\n\n\n\n\npl.DataFrame\nDataFrame with fixed_time_horizons and the estimated probabilities for states 0, 1 and 2.",
    "crumbs": [
      "Reference",
      "Some functions",
      "predict"
    ]
  }
]